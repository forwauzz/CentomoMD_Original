# CentomoMD Environment Configuration
# Copy this file to .env and fill in your actual values

# =============================================================================
# APPLICATION CONFIGURATION
# =============================================================================
NODE_ENV=development
PORT=3001
HOST=localhost
CORS_ORIGIN=http://localhost:5173
API_VERSION=v1

# =============================================================================
# AWS CONFIGURATION
# =============================================================================
AWS_REGION=ca-central-1
AWS_ACCESS_KEY_ID=your_aws_access_key_id
AWS_SECRET_ACCESS_KEY=your_aws_secret_access_key
AWS_SESSION_TOKEN=your_aws_session_token  # Optional, for temporary credentials

# S3 Configuration
AWS_S3_BUCKET=centomomd-transcription-dev-123456789012
AWS_S3_PREFIX=transcripts/
AWS_S3_LIFECYCLE_DAYS=1

# Transcribe Configuration
AWS_TRANSCRIBE_LANGUAGE_OPTIONS=en-US,fr-CA
AWS_TRANSCRIBE_PREFERRED_LANGUAGE=fr-CA
# DEPRECATED: AWS_TRANSCRIBE_MEDIA_SAMPLE_RATE_HZ is now negotiated at runtime
# AWS_TRANSCRIBE_MEDIA_SAMPLE_RATE_HZ=16000
AWS_TRANSCRIBE_MEDIA_ENCODING=pcm
AWS_TRANSCRIBE_SHOW_SPEAKER_LABELS=true
AWS_TRANSCRIBE_MAX_SPEAKER_LABELS=2

# =============================================================================
# SUPABASE CONFIGURATION
# =============================================================================
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_ANON_KEY=your_supabase_anon_key
SUPABASE_SERVICE_ROLE_KEY=your_supabase_service_role_key
SUPABASE_JWT_SECRET=your_jwt_secret

# =============================================================================
# AUTH CONFIGURATION
# =============================================================================
# Feature flags (default to false for safe rollout)
AUTH_REQUIRED=false
WS_REQUIRE_AUTH=false

# Auth verification strategy (supabase or jwks)
AUTH_VERIFY_STRATEGY=supabase
JWKS_URL=https://your-domain/.well-known/jwks.json

# WebSocket JWT secret (required when WS_REQUIRE_AUTH=true)
WS_JWT_SECRET=your_ws_jwt_secret_here_make_it_long_and_random_32_chars_min

# WebSocket configuration
WS_PATH=/ws
PUBLIC_WS_URL=wss://api.alie.app/ws
USE_WSS=false

# Security configuration
CORS_ALLOWED_ORIGINS=http://localhost:5173,https://yourdomain.com
RATE_LIMIT_ENABLED=false

# Debug configuration
LOG_PAYLOADS=false
DIAG_MODE=false

# Database Configuration
DATABASE_URL=postgresql://username:password@host:port/database
DATABASE_SSL=true

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================
JWT_SECRET=your_jwt_secret_key_here_make_it_long_and_random
JWT_EXPIRES_IN=24h
BCRYPT_ROUNDS=12

# CORS Configuration
CORS_ALLOWED_ORIGINS=http://localhost:5173,https://azure-production.d1deo9tihdnt50.amplifyapp.com,https://www.centomomd.com
CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_ALLOWED_HEADERS=Content-Type,Authorization,X-Requested-With

# Rate Limiting
RATE_LIMIT_WINDOW_MS=900000  # 15 minutes
RATE_LIMIT_MAX_REQUESTS=100

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================
LOG_LEVEL=info
LOG_FORMAT=json
LOG_FILE_PATH=logs/
LOG_MAX_SIZE=10m
LOG_MAX_FILES=5

# Audit Logging
AUDIT_LOG_ENABLED=true
AUDIT_LOG_RETENTION_DAYS=2555  # 7 years for compliance

# =============================================================================
# COMPLIANCE CONFIGURATION
# =============================================================================
COMPLIANCE_HIPAA_ENABLED=true
COMPLIANCE_PIPEDA_ENABLED=true
COMPLIANCE_LAW25_ENABLED=true
COMPLIANCE_DATA_RESIDENCY=ca-central-1
COMPLIANCE_ZERO_RETENTION=true
COMPLIANCE_PHI_FREE_LOGGING=true

# Encryption
ENCRYPTION_ALGORITHM=AES-256-GCM
ENCRYPTION_KEY=your_encryption_key_here

# =============================================================================
# TRANSCRIPTION CONFIGURATION
# =============================================================================
TRANSCRIPTION_MAX_DURATION_SECONDS=3600  # 1 hour
TRANSCRIPTION_AUTO_RECONNECT=true
TRANSCRIPTION_MAX_RECONNECT_ATTEMPTS=3
TRANSCRIPTION_RECONNECT_DELAY_MS=2000

# Voice Commands
VOICE_COMMANDS_ENABLED=true
VOICE_COMMANDS_CONFIDENCE_THRESHOLD=0.8

# =============================================================================
# EXPORT CONFIGURATION
# =============================================================================
EXPORT_MAX_FILE_SIZE_MB=50
EXPORT_ALLOWED_FORMATS=docx,pdf
EXPORT_TEMP_DIR=temp/exports/
EXPORT_CLEANUP_INTERVAL_HOURS=24

# =============================================================================
# PERFORMANCE CONFIGURATION
# =============================================================================
PERFORMANCE_MONITORING_ENABLED=true
PERFORMANCE_SLOW_QUERY_THRESHOLD_MS=1000
PERFORMANCE_MEMORY_WARNING_THRESHOLD_MB=512

# WebSocket Configuration
WEBSOCKET_HEARTBEAT_INTERVAL_MS=30000
WEBSOCKET_MAX_PAYLOAD_SIZE_BYTES=1048576  # 1MB

# =============================================================================
# DEVELOPMENT CONFIGURATION
# =============================================================================
# Only set these in development
DEBUG_MODE=false
DEBUG_LOG_LEVEL=debug
DEBUG_SHOW_ERRORS=true

# =============================================================================
# MONITORING CONFIGURATION
# =============================================================================
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_INTERVAL_MS=30000
METRICS_ENABLED=true
METRICS_PORT=9090

# =============================================================================
# BACKUP CONFIGURATION
# =============================================================================
BACKUP_ENABLED=false
BACKUP_SCHEDULE=0 2 * * *  # Daily at 2 AM
BACKUP_RETENTION_DAYS=30

# =============================================================================
# NOTIFICATION CONFIGURATION
# =============================================================================
# Email notifications (optional)
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your_email@gmail.com
SMTP_PASS=your_app_password
SMTP_FROM=noreply@centomomd.com

# =============================================================================
# OPENAI CONFIGURATION
# =============================================================================
# OpenAI API Key for AI formatting (Section 7 AI Formatter)
OPENAI_API_KEY=your_openai_api_key_here

# OpenAI Model Configuration
OPENAI_MODEL=gpt-4o-mini
OPENAI_TEMPERATURE=0.2
OPENAI_MAX_TOKENS=4000

# AI Provider API Keys (for multi-model support)
ANTHROPIC_API_KEY=your_anthropic_api_key_here  # Optional, for Claude models
GOOGLE_API_KEY=your_google_api_key_here  # Optional, for Gemini models

# Model Selection Feature Flags
FEATURE_MODEL_SELECTION=false
FEATURE_MODEL_SELECTION_TRANSCRIPT_ANALYSIS=false
FEATURE_MODEL_SELECTION_TEMPLATE_COMBINATIONS=false
FEATURE_MODEL_SELECTION_DICTATION=false

# Model Version Feature Flags (for future models)
FEATURE_GPT5=false  # Enable GPT-5 models (gpt-5, gpt-5-mini, gpt-5-turbo)
FEATURE_CLAUDE4=false  # Enable Claude 4 models
FEATURE_GEMINI2=false  # Enable Gemini 2 models
FEATURE_LLAMA=false  # Enable Llama models (requires Llama API key)
FEATURE_MISTRAL=false  # Enable Mistral models (requires Mistral API key)

# Enhanced Transcript Analysis
FEATURE_ENHANCED_TRANSCRIPT_ANALYSIS=false
FEATURE_TEMPLATE_COMBINATIONS_IN_ANALYSIS=false

# Layer Processing
FEATURE_LAYER_PROCESSING=false

# Experiment Allowlist (comma-separated emails)
EXPERIMENT_ALLOWLIST=

# Cost Controls
MAX_COST_PER_RUN=0.50  # Maximum cost per run in USD

# Default Model Configuration
DEFAULT_AI_MODEL=gpt-4o-mini
DEFAULT_AI_PROVIDER=openai

# =============================================================================
# FEATURE FLAGS
# =============================================================================
FEATURE_REAL_TIME_PREVIEW=true
FEATURE_VOICE_COMMANDS=true
FEATURE_AI_FORMATTING=true
FEATURE_EXPORT=true
FEATURE_AUDIT_LOGGING=true
FEATURE_FEEDBACK_SERVER_SYNC=false

# Universal Cleanup Feature Flag
UNIVERSAL_CLEANUP_ENABLED=false
UNIVERSAL_CLEANUP_SHADOW=false

# Output Language Selection Feature Flags
ENABLE_OUTPUT_LANGUAGE_SELECTION=true
CNESST_SECTIONS_DEFAULT_OUTPUT=fr
ALLOW_NON_FRENCH_OUTPUT=false

# Performance and Caching Configuration
SLO_P95_MS=5000
SLO_P99_MS=8000
CACHE_TTL_SECONDS=604800

# =============================================================================
# AUDIO PIPELINE FEATURE FLAGS
# =============================================================================
# Sample rate negotiation (enables runtime negotiation of 44100/48000)
AUDIO_SR_NEGOTIATE=true

# Legacy 16kHz support (fallback for older clients)
AUDIO_V1_LEGACY_16K=false

# Transcribe stabilization level (off|low|medium|high)
TRANSCRIBE_STABILIZATION=high

# Enable speaker labels in transcription
TRANSCRIBE_SPEAKER_LABELS=false

# Debug binary frame logging
WS_DEBUG_BINARY_LOG=false

# =============================================================================
# FRONTEND ENVIRONMENT VARIABLES (for Amplify/Vercel)
# =============================================================================
# WebSocket Configuration
VITE_WS_URL=wss://api.alie.app/ws
VITE_API_BASE_URL=https://api.alie.app

# Supabase Configuration (Frontend)
VITE_SUPABASE_URL=https://your-project.supabase.co
VITE_SUPABASE_ANON_KEY=your_supabase_anon_key

# Frontend Feature Flags
VITE_FEATURE_VOICE_COMMANDS=true
VITE_FEATURE_VERBATIM=true
VITE_FEATURE_MACROS=false
VITE_FEATURE_TRANSCRIPT_ANALYSIS_PIPELINE=true
VITE_FEATURE_SPEAKER_LABELING=true
VITE_FEATURE_FEEDBACK_MODULE=true
VITE_FEATURE_FEEDBACK_SERVER_SYNC=false
VITE_FEATURE_OUTPUT_LANGUAGE_SELECTION=true
VITE_FEATURE_CASE_MANAGEMENT=true
VITE_FEATURE_LANDING_PAGE=false